<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioteca Teológica Digital</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        button {
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 10px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .study-list {
            list-style: none;
            padding: 0;
        }
        .study-list li {
            padding: 10px;
            background: #eee;
            margin: 5px 0;
            border-radius: 5px;
            cursor: pointer;
        }
        #study-content {
            display: none;
            text-align: left;
        }
        #error-message {
            color: red;
            font-weight: bold;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Biblioteca Teológica Digital</h1>
        
        <button onclick="showAllStudies()">Ver todos los estudios</button>
        <button onclick="searchByKeyword()">Buscar por palabra</button>
        <button onclick="searchByBook()">Buscar por libro de la Biblia</button>
        <button onclick="searchByDate()">Buscar por fecha</button>
        
        <div id="search-box" style="margin-top: 10px;">
            <input type="text" id="search-input" placeholder="Escriba aquí..." oninput="filterStudies()">
        </div>

        <ul id="study-list" class="study-list"></ul>
        <h2>Archivos PDF Disponibles</h2>
        <p id="error-message"></p> <!-- Mensaje de error aquí -->
        <ul id="pdf-list" class="study-list"></ul>

        <div id="study-content">
            <button onclick="goBack()">Volver al inicio</button>
            <h2 id="study-title"></h2>
            <p><strong>Fecha de publicación:</strong> <span id="study-date"></span></p>
            <p id="study-body"></p>
        </div>
    </div>

    <script>
        const studies = [
            { title: "La Soberanía de Dios", content: "Contenido del estudio sobre la soberanía de Dios.", date: "2024-02-01", books: ["Romanos"] },
            { title: "El Amor de Cristo", content: "Contenido sobre el amor de Cristo en la vida del creyente.", date: "2024-01-15", books: ["Juan"] },
            { title: "La Justificación por la Fe", content: "Estudio sobre la doctrina de la justificación.", date: "2023-12-10", books: ["Gálatas", "Romanos"] }
        ];

        function showAllStudies() {
            document.getElementById("study-list").innerHTML = "";
            studies.sort((a, b) => a.title.localeCompare(b.title));
            studies.forEach(study => addStudyToList(study));
        }

        function addStudyToList(study) {
            let li = document.createElement("li");
            li.textContent = study.title;
            li.onclick = () => showStudy(study);
            document.getElementById("study-list").appendChild(li);
        }

        function showStudy(study) {
            document.getElementById("study-content").style.display = "block";
            document.getElementById("study-list").style.display = "none";
            document.getElementById("search-box").style.display = "none";
            document.getElementById("study-title").textContent = study.title;
            document.getElementById("study-date").textContent = study.date;
            document.getElementById("study-body").textContent = study.content;
        }

        function goBack() {
            document.getElementById("study-content").style.display = "none";
            document.getElementById("study-list").style.display = "block";
            document.getElementById("search-box").style.display = "block";
        }

        function searchByBook() {
            let book = prompt("Ingrese el libro de la Biblia");
            if (book) {
                book = book.toLowerCase(); // Normalizar a minúsculas
                document.getElementById("study-list").innerHTML = "";
                let filtered = studies.filter(study => study.books.some(b => b.toLowerCase() === book));
                if (filtered.length === 0) {
                    alert("No se encontraron estudios para este libro.");
                }
                filtered.forEach(study => addStudyToList(study));
            }
        }

        function searchByDate() {
            let date = prompt("Ingrese la fecha en formato YYYY-MM-DD");
            let dateRegex = /^\d{4}-\d{2}-\d{2}$/;
            if (!dateRegex.test(date)) {
                alert("Formato de fecha incorrecto. Use YYYY-MM-DD.");
                return;
            }
            document.getElementById("study-list").innerHTML = "";
            let filtered = studies.filter(study => study.date === date);
            if (filtered.length === 0) {
                alert("No se encontraron estudios para esta fecha.");
            }
            filtered.forEach(study => addStudyToList(study));
        }

        async function fetchPDFs() {
            try {
                const response = await fetch("TU_NUEVA_URL_DEL_SCRIPT");
                if (!response.ok) throw new Error("Error al obtener los archivos PDF");
                const pdfs = await response.json();
                
                const pdfList = document.getElementById("pdf-list");
                pdfList.innerHTML = ""; 

                pdfs.forEach(pdf => {
                    let li = document.createElement("li");
                    let link = document.createElement("a");
                    link.href = pdf.url;
                    link.textContent = pdf.name;
                    link.target = "_blank";
                    li.appendChild(link);
                    pdfList.appendChild(li);
                });

            } catch (error) {
                document.getElementById("error-message").textContent = "No se pudieron cargar los PDFs.";
                console.error("Error cargando los PDFs:", error);
            }
        }

        fetchPDFs();
        showAllStudies();
    </script>
</body>
</html>
